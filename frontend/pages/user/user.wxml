<!--ç”¨æˆ·ä¸­å¿ƒé¡µé¢-->
<view class="user-container">
  <!-- ç”¨æˆ·ä¿¡æ¯å¤´éƒ¨ -->
  <view class="user-header">
    <view class="user-info" bind:tap="goToProfile">
      <view class="avatar-section">
        <image class="user-avatar" src="{{userInfo.avatar || '/images/default-avatar.png'}}" mode="aspectFill"/>
        <view class="login-status" wx:if="{{!userInfo.id}}">
          <text class="login-text">ç‚¹å‡»ç™»å½•</text>
        </view>
      </view>
      <view class="user-details">
        <view class="user-name" wx:if="{{userInfo.id}}">{{userInfo.nickname || 'å¾®ä¿¡ç”¨æˆ·'}}</view>
        <view class="user-name" wx:else>æœªç™»å½•</view>
        <view class="user-phone" wx:if="{{userInfo.phone}}">{{userInfo.phone}}</view>
        <view class="user-phone" wx:else>ç»‘å®šæ‰‹æœºå·äº«å—æ›´å¤šæœåŠ¡</view>
      </view>
      <view class="arrow">></view>
    </view>
    
    <!-- ç”¨æˆ·ç»Ÿè®¡ä¿¡æ¯ -->
    <view class="user-stats" wx:if="{{userInfo.id}}">
      <view class="stat-item" bind:tap="goToOrders" data-status="pending">
        <text class="stat-number">{{stats.pending || 0}}</text>
        <text class="stat-label">å¾…ä»˜æ¬¾</text>
      </view>
      <view class="stat-item" bind:tap="goToOrders" data-status="shipped">
        <text class="stat-number">{{stats.shipped || 0}}</text>
        <text class="stat-label">å¾…æ”¶è´§</text>
      </view>
      <view class="stat-item" bind:tap="goToOrders" data-status="delivered">
        <text class="stat-number">{{stats.delivered || 0}}</text>
        <text class="stat-label">å¾…è¯„ä»·</text>
      </view>
      <view class="stat-item" bind:tap="goToFavorites">
        <text class="stat-number">{{stats.favorites || 0}}</text>
        <text class="stat-label">æ”¶è—</text>
      </view>
    </view>
  </view>

  <!-- è®¢å•ç®¡ç† -->
  <view class="order-section">
    <view class="section-header" bind:tap="goToOrders">
      <text class="section-title">æˆ‘çš„è®¢å•</text>
      <text class="section-subtitle">æŸ¥çœ‹å…¨éƒ¨è®¢å•</text>
      <text class="arrow">></text>
    </view>
    <view class="order-types">
      <view class="order-type" bind:tap="goToOrders" data-status="pending">
        <image class="type-icon" src="/images/order/pending.png" mode="aspectFit"/>
        <text class="type-text">å¾…ä»˜æ¬¾</text>
        <view class="badge" wx:if="{{stats.pending > 0}}">{{stats.pending}}</view>
      </view>
      <view class="order-type" bind:tap="goToOrders" data-status="paid">
        <image class="type-icon" src="/images/order/paid.png" mode="aspectFit"/>
        <text class="type-text">å¾…å‘è´§</text>
        <view class="badge" wx:if="{{stats.paid > 0}}">{{stats.paid}}</view>
      </view>
      <view class="order-type" bind:tap="goToOrders" data-status="shipped">
        <image class="type-icon" src="/images/order/shipped.png" mode="aspectFit"/>
        <text class="order-type" bind:tap="goToOrders" data-status="shipped">
        <image class="type-icon" src="/images/order/shipped.png" mode="aspectFit"/>
        <text class="type-text">å¾…æ”¶è´§</text>
        <view class="badge" wx:if="{{stats.shipped > 0}}">{{stats.shipped}}</view>
      </view>
      <view class="order-type" bind:tap="goToOrders" data-status="delivered">
        <image class="type-icon" src="/images/order/delivered.png" mode="aspectFit"/>
        <text class="type-text">å¾…è¯„ä»·</text>
        <view class="badge" wx:if="{{stats.delivered > 0}}">{{stats.delivered}}</view>
      </view>
      <view class="order-type" bind:tap="goToOrders" data-status="refund">
        <image class="type-icon" src="/images/order/refund.png" mode="aspectFit"/>
        <text class="type-text">é€€æ¬¾/å”®å</text>
        <view class="badge" wx:if="{{stats.refund > 0}}">{{stats.refund}}</view>
      </view>
    </view>
  </view>

  <!-- åŠŸèƒ½èœå• -->
  <view class="menu-section">
    <view class="menu-group">
      <view class="menu-item" bind:tap="goToAddress">
        <view class="menu-icon">ğŸ“</view>
        <text class="menu-text">æ”¶è´§åœ°å€</text>
        <text class="arrow">></text>
      </view>
      <view class="menu-item" bind:tap="goToFavorites">
        <view class="menu-icon">â¤ï¸</view>
        <text class="menu-text">æˆ‘çš„æ”¶è—</text>
        <text class="arrow">></text>
      </view>
      <view class="menu-item" bind:tap="goToCoupons">
        <view class="menu-icon">ğŸ«</view>
        <text class="menu-text">ä¼˜æƒ åˆ¸</text>
        <text class="arrow">></text>
      </view>
    </view>

    <view class="menu-group">
      <view class="menu-item" bind:tap="goToCustomerService">
        <view class="menu-icon">ğŸ’¬</view>
        <text class="menu-text">è”ç³»å®¢æœ</text>
        <text class="arrow">></text>
      </view>
      <view class="menu-item" bind:tap="goToFeedback">
        <view class="menu-icon">ğŸ“</view>
        <text class="menu-text">æ„è§åé¦ˆ</text>
        <text class="arrow">></text>
      </view>
      <view class="menu-item" bind:tap="goToAbout">
        <view class="menu-icon">â„¹ï¸</view>
        <text class="menu-text">å…³äºæˆ‘ä»¬</text>
        <text class="arrow">></text>
      </view>
    </view>

    <view class="menu-group">
      <view class="menu-item" bind:tap="goToSettings">
        <view class="menu-icon">âš™ï¸</view>
        <text class="menu-text">è®¾ç½®</text>
        <text class="arrow">></text>
      </view>
    </view>
  </view>

  <!-- é€€å‡ºç™»å½• -->
  <view class="logout-section" wx:if="{{userInfo.id}}">
    <button class="logout-btn" bind:tap="logout">é€€å‡ºç™»å½•</button>
  </view>

  <!-- æœªç™»å½•æç¤º -->
  <view class="login-prompt" wx:if="{{!userInfo.id}}">
    <text class="prompt-text">ç™»å½•åäº«å—æ›´å¤šæœåŠ¡</text>
    <button class="login-btn" bind:tap="goToLogin">ç«‹å³ç™»å½•</button>
  </view>
</view>

<!-- åŠ è½½çŠ¶æ€ -->
<view class="loading" wx:if="{{loading}}">
  <text>åŠ è½½ä¸­...</text>
</view>