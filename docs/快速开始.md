# 笑姐家农产品微信小程序商城 - 快速开始指南

## 项目概述

这是一个完整的农产品微信小程序商城项目，包含：
- 微信小程序前端
- 后端API服务
- 管理后台
- 完整的部署方案

## 环境要求

### 开发环境
- Node.js 16+
- MySQL 8.0
- Redis 6.0
- 微信开发者工具

### 生产环境
- Docker & Docker Compose
- 云服务器（推荐阿里云/腾讯云）
- 域名和SSL证书

## 快速启动

### 1. 克隆项目
```bash
git clone <项目地址>
cd xiaojie-farm
```

### 2. 环境配置

#### 后端配置
```bash
cd backend
cp .env.example .env
# 编辑 .env 文件，配置数据库、Redis、微信等参数
```

#### 前端配置
```bash
cd frontend
# 使用微信开发者工具打开此目录
# 配置小程序AppID
```

### 3. 安装依赖
```bash
# 后端依赖
cd backend
npm install

# 管理后台依赖
cd ../admin
npm install
```

### 4. 数据库初始化
```bash
cd backend
npm run migrate
```

### 5. 启动服务

#### 开发模式
```bash
# 启动后端服务
cd backend
npm run dev

# 启动管理后台
cd ../admin
npm run dev
```

#### 生产模式（Docker）
```bash
cd docker
docker-compose up -d
```

### 6. 访问服务
- 后端API: http://localhost:3000
- 管理后台: http://localhost:3001
- 健康检查: http://localhost:3000/health

## 项目结构

```
xiaojie-farm/
├── frontend/          # 微信小程序前端
│   ├── pages/        # 页面文件
│   ├── app.js        # 小程序入口
│   └── app.json      # 小程序配置
├── backend/           # 后端API服务
│   ├── routes/       # 路由文件
│   ├── middleware/   # 中间件
│   ├── config/       # 配置文件
│   └── scripts/      # 脚本文件
├── admin/             # 管理后台
├── docs/              # 项目文档
├── scripts/           # 部署脚本
└── docker/            # Docker配置
```

## 核心功能

### 用户端功能
- [x] 微信授权登录
- [x] 商品展示与搜索
- [x] 购物车管理
- [x] 订单管理
- [x] 个人中心

### 商家端功能
- [x] 商品管理
- [x] 订单处理
- [x] 库存管理
- [x] 数据统计

### 管理端功能
- [x] 用户管理
- [x] 商品审核
- [x] 系统配置
- [x] 数据报表

## API接口

### 认证接口
- `POST /api/auth/wechat-login` - 微信登录
- `POST /api/auth/logout` - 用户登出
- `GET /api/auth/me` - 获取用户信息

### 商品接口
- `GET /api/products` - 获取商品列表
- `GET /api/products/:id` - 获取商品详情
- `GET /api/products/hot/list` - 获取热门商品
- `GET /api/products/recommend/list` - 获取推荐商品

### 购物车接口
- `GET /api/cart` - 获取购物车
- `POST /api/cart/add` - 添加到购物车
- `PUT /api/cart/update` - 更新购物车
- `DELETE /api/cart/remove/:id` - 删除购物车商品

## 数据库设计

### 核心表结构
- `users` - 用户表
- `products` - 商品表
- `categories` - 分类表
- `orders` - 订单表
- `order_items` - 订单商品表
- `cart` - 购物车表（Redis）

## 部署说明

### 开发环境部署
```bash
# 使用部署脚本
./scripts/deploy.sh dev deploy
```

### 生产环境部署
```bash
# 生产环境部署
./scripts/deploy.sh prod deploy

# 查看服务状态
./scripts/deploy.sh prod status

# 备份数据
./scripts/deploy.sh prod backup
```

### 环境变量配置

#### 开发环境 (.env.dev)
```env
NODE_ENV=development
PORT=3000
DB_HOST=localhost
DB_PORT=3306
DB_USER=root
DB_PASSWORD=your_password
DB_NAME=xiaojie_farm
```

#### 生产环境 (.env.prod)
```env
NODE_ENV=production
PORT=3000
DB_HOST=mysql
DB_PORT=3306
DB_USER=xiaojie
DB_PASSWORD=secure_password
DB_NAME=xiaojie_farm
REDIS_HOST=redis
REDIS_PORT=6379
```

## 微信小程序配置

### 1. 申请小程序账号
- 访问 [微信公众平台](https://mp.weixin.qq.com/)
- 注册小程序账号
- 获取AppID和AppSecret

### 2. 配置开发工具
- 下载 [微信开发者工具](https://developers.weixin.qq.com/miniprogram/dev/devtools/download.html)
- 导入项目目录
- 配置AppID

### 3. 配置服务器域名
- 在微信公众平台配置服务器域名
- 添加request合法域名
- 配置uploadFile合法域名

## 常见问题

### Q: 数据库连接失败
A: 检查MySQL服务是否启动，用户名密码是否正确

### Q: Redis连接失败
A: 检查Redis服务是否启动，端口是否正确

### Q: 微信登录失败
A: 检查AppID和AppSecret是否正确配置

### Q: 上传文件失败
A: 检查阿里云OSS配置，确保有正确的访问权限

## 开发规范

### 代码规范
- 使用ESLint进行代码检查
- 遵循JavaScript Standard Style
- 使用Prettier进行代码格式化

### 提交规范
- feat: 新功能
- fix: 修复bug
- docs: 文档更新
- style: 代码格式调整
- refactor: 代码重构
- test: 测试相关
- chore: 构建过程或辅助工具的变动

### 分支管理
- `main`: 主分支，用于生产环境
- `develop`: 开发分支
- `feature/*`: 功能分支
- `hotfix/*`: 热修复分支

## 技术支持

### 联系方式
- 项目负责人：[您的姓名]
- 邮箱：[您的邮箱]
- 微信：[您的微信号]

### 问题反馈
- 提交Issue到项目仓库
- 发送邮件到技术支持邮箱
- 通过微信联系技术支持

## 更新日志

### v1.0.0 (2024-01-01)
- 初始版本发布
- 基础功能实现
- 微信小程序集成
- 管理后台开发

---

*本指南会持续更新，如有疑问请及时联系技术支持*